__CONFIG _CP_OFF & _WDT_OFF & _PWRTE_ON & _XT_OSC
    LIST P=16F84A
    INCLUDE <P16F84A.INC>
    ORG 0
    
   SEGUNDOSR	EQU	0X0C
   MINUTOSR    EQU	0X0D
   HORASR	EQU	0X0E
   SECL	EQU	0X0F	
   MINL	EQU	0X10
   HORL	EQU	0X11
   VUELTAS	EQU	0X12
   TGIRO	EQU	0X13
   CONTHORAS	EQU	0X14
   CONTMIN	EQU	0X15
   CONTSEC	EQU	0X16
   LETREG	EQU	0X17
    VUELTAS2    EQU	0X18
	
    
   INICIO
    BSF	STATUS,RP0
    CLRF    TRISB
    BCF	STATUS,RP0
    
    CLRF    SEGUNDOSR
    CLRF    MINUTOSR
    CLRF    HORASR
    CLRF    SECL
    CLRF    MINL
    CLRF    HORL
    

    
    
   RELOJ
    
	CLRF	HORASR
	MOVLW	D'60'
	MOVWF	CONTHORAS
	CLRF	MINUTOSR
   HPS
	MOVLW	D'60'
	MOVWF	CONTMIN
	CLRF    SEGUNDOSR
   MPS
	MOVLW	D'60'
	MOVWF	CONTSEC
	
	
   SPS	
	CALL	GIROSEC
	INCF	SEGUNDOSR
	DECFSZ	CONTSEC
	GOTO	SPS
	
    
	INCF	MINUTOSR
	DECFSZ	CONTMIN
	GOTO	MPS
	
    
	INCF	HORASR
	DECFSZ	CONTHORAS
	GOTO	MPS
	GOTO	RELOJ

	
	GOTO	RELOJ
    
   GIROSEC
   	
	MOVLW	D'255';SE DEBE DE AJUSTAR AL NUMERO DE VUELTAS EN UN 1SEC
	MOVWF	VUELTAS2
   V2
	MOVLW	D'255';SE DEBE DE AJUSTAR AL NUMERO DE VUELTAS EN UN 1SEC
	MOVWF	VUELTAS
   V
	CALL	TSOLOGIRO
	DECFSZ	VUELTAS
	GOTO	V
	
	DECFSZ	VUELTAS2
	GOTO	V2 
	
	RETURN
	
    
    
    
   TSOLOGIRO ;RUTINA DE UN  SOLO GIRO
	MOVF	SEGUNDOSR,0
	MOVWF	SECL
	MOVF	MINUTOSR,0
	MOVWF	MINL
	MOVF	HORASR,0
	MOVWF	HORL
	MOVLW	D'60'
	MOVWF	TGIRO
	MOVLW	B'00000000'
	MOVWF	PORTB
   LETANIA
	MOVLW	D'255';SECUENCIAS DE REPETICON PARA HACER UNA ESPERA MAS GRANDE
	MOVWF	LETREG
   LET
	NOP
	DECFSZ	LETREG
	GOTO LET
	
   T
	DECFSZ	SECL
	GOTO	M
	CALL	OFFSEC
   M	DECFSZ	MINL
	GOTO	H
	CALL	OFFMIN
   H	DECFSZ	HORL
	GOTO	DG
	CALL	OFFHORA   
   DG	DECFSZ	TGIRO
	GOTO	LETANIA
	RETURN
	
   OFFSEC
	MOVF	PORTB,0
	ANDLW	B'11111100'
	MOVWF	PORTB
    RETURN
    
   OFFMIN
	MOVF	PORTB,0
	ANDLW	B'11111010'
	MOVWF	PORTB
    RETURN
    
   OFFHORA
	MOVF	PORTB,0
	ANDLW	B'11111001'
	MOVWF	PORTB
    RETURN

END